# LangGraph Stream Modes ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

`run_signal_subgraph_stream` å‡½æ•°ç°åœ¨æ”¯æŒ LangGraph çš„å¤šç§æµå¼è¾“å‡ºæ¨¡å¼ï¼Œå¹¶ä½¿ç”¨ `rich` åº“æä¾›ç¾åŒ–çš„ç»ˆç«¯è¾“å‡ºã€‚

## Stream Modes

### 1. `updates` æ¨¡å¼ï¼ˆæ¨èï¼Œé»˜è®¤ï¼‰

**ç‰¹ç‚¹**ï¼š
- ä»…æ˜¾ç¤ºæ¯æ­¥çš„çŠ¶æ€å˜åŒ–
- è¾“å‡ºç®€æ´æ¸…æ™°
- é€‚åˆæ—¥å¸¸è°ƒè¯•å’Œç›‘æ§

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```python
from src.subgraphs.signal import create_signal_subgraph, run_signal_subgraph_stream, SignalSubgraphState

graph = create_signal_subgraph()
initial_state = {...}

# ä½¿ç”¨ updates æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
final_state = run_signal_subgraph_stream(
    compiled_graph=graph,
    initial_state=initial_state,
    verbose=True,
    stream_mode="updates"  # å¯çœç•¥ï¼Œé»˜è®¤å€¼
)
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
============================================================
                    ğŸš€ å¼€å§‹æµå¼æ‰§è¡Œä¿¡å·ç”Ÿæˆå­å›¾                    
============================================================

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ”¹ èŠ‚ç‚¹: reflection (æ­¥éª¤ 1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ“‹ å½“å‰ä»»åŠ¡: åˆ†æç”¨æˆ·æ„å›¾                                  â”‚
â”‚ âš¡ æœ€æ–°æ‰§è¡Œ: å·²è¯†åˆ«æ•°æ®è·å–éœ€æ±‚                            â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ”¹ èŠ‚ç‚¹: data_fetch (æ­¥éª¤ 2) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ“‹ å½“å‰ä»»åŠ¡: è·å– OHLCV æ•°æ®                              â”‚
â”‚ ğŸ“Š æ•°æ®çŠ¶æ€: OHLCV=âœ“, æŒ‡æ ‡=âœ—, ä¿¡å·=âœ—                      â”‚
â”‚ âš¡ æœ€æ–°æ‰§è¡Œ: æˆåŠŸè·å–000001.SZæ•°æ®                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

============================================================
                        âœ… å­å›¾æ‰§è¡Œå®Œæˆ                        
============================================================

            ğŸ“ˆ æ‰§è¡Œæ‘˜è¦             
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ OHLCVæ•°æ®            â”‚ âœ… å°±ç»ª   â•‘
â•‘ æŒ‡æ ‡æ•°æ®             â”‚ âŒ æœªå°±ç»ª â•‘
â•‘ äº¤æ˜“ä¿¡å·             â”‚ âŒ æœªå°±ç»ª â•‘
â•‘ æ‰§è¡Œæ­¥éª¤æ•°           â”‚ 3         â•‘
â•‘ é”™è¯¯æ¬¡æ•°             â”‚ 0         â•‘
â•‘ é‡è¯•æ¬¡æ•°             â”‚ 0         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2. `values` æ¨¡å¼

**ç‰¹ç‚¹**ï¼š
- æ¯æ­¥è¾“å‡ºå®Œæ•´çŠ¶æ€
- ä¿¡æ¯é‡å¤§ï¼Œé€‚åˆæ·±åº¦è°ƒè¯•
- å¯ä»¥çœ‹åˆ°æ‰€æœ‰çŠ¶æ€å­—æ®µçš„å˜åŒ–

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```python
final_state = run_signal_subgraph_stream(
    compiled_graph=graph,
    initial_state=initial_state,
    verbose=True,
    stream_mode="values"  # å®Œæ•´çŠ¶æ€æ¨¡å¼
)
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
============================================================
                    ğŸš€ å¼€å§‹æµå¼æ‰§è¡Œä¿¡å·ç”Ÿæˆå­å›¾                    
============================================================

ğŸ“¦ å®Œæ•´çŠ¶æ€ (æ­¥éª¤ 1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­—æ®µ                 â”‚ å€¼                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ current_task         â”‚ åˆ†æç”¨æˆ·æ„å›¾        â”‚
â”‚ data_ready           â”‚ âœ—                   â”‚
â”‚ indicators_ready     â”‚ âœ—                   â”‚
â”‚ signal_ready         â”‚ âœ—                   â”‚
â”‚ retry_count          â”‚ 0                   â”‚
â”‚ max_retries          â”‚ 3                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. `debug` æ¨¡å¼

**ç‰¹ç‚¹**ï¼š
- è¾“å‡ºæœ€è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
- åŒ…å«èŠ‚ç‚¹æ‰§è¡Œå…ƒæ•°æ®
- é€‚åˆæ’æŸ¥å¤æ‚é—®é¢˜

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```python
final_state = run_signal_subgraph_stream(
    compiled_graph=graph,
    initial_state=initial_state,
    verbose=True,
    stream_mode="debug"  # è°ƒè¯•æ¨¡å¼
)
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
============================================================
                    ğŸš€ å¼€å§‹æµå¼æ‰§è¡Œä¿¡å·ç”Ÿæˆå­å›¾                    
============================================================

ğŸ“Š è°ƒè¯•ä¿¡æ¯ (æ­¥éª¤ 1)
{
    'type': 'task',
    'timestamp': '2024-01-01T10:00:00',
    'task': {'id': 'xxx', 'name': 'reflection', 'path': ['reflection']},
    'payload': {...},
    'metadata': {...}
}
```

## é™é»˜æ¨¡å¼

å¦‚æœä¸éœ€è¦ä»»ä½•è¾“å‡ºï¼Œå¯ä»¥è®¾ç½® `verbose=False`ï¼š

```python
final_state = run_signal_subgraph_stream(
    compiled_graph=graph,
    initial_state=initial_state,
    verbose=False  # ä¸æ‰“å°ä»»ä½•ä¿¡æ¯
)
```

## ç¾åŒ–è¾“å‡ºç‰¹æ€§

ä½¿ç”¨ `rich` åº“æä¾›çš„ç¾åŒ–è¾“å‡ºåŒ…æ‹¬ï¼š

1. **é¢æ¿ï¼ˆPanelï¼‰**ï¼šèŠ‚ç‚¹æ‰§è¡Œä¿¡æ¯ä»¥å¸¦è¾¹æ¡†çš„é¢æ¿å½¢å¼å±•ç¤º
2. **è¡¨æ ¼ï¼ˆTableï¼‰**ï¼šæ‰§è¡Œæ‘˜è¦ä»¥è¡¨æ ¼å½¢å¼æ¸…æ™°å±•ç¤º
3. **é¢œè‰²å’Œæ ·å¼**ï¼šä¸åŒç±»å‹çš„ä¿¡æ¯ä½¿ç”¨ä¸åŒé¢œè‰²
   - é’è‰²ï¼šæ ‡é¢˜å’Œå­—æ®µå
   - ç™½è‰²ï¼šæ­£å¸¸å†…å®¹
   - çº¢è‰²ï¼šé”™è¯¯ä¿¡æ¯
   - é»„è‰²ï¼šè­¦å‘Šå’Œæ¾„æ¸…éœ€æ±‚
   - ç»¿è‰²ï¼šæˆåŠŸä¿¡æ¯
4. **å›¾æ ‡**ï¼šä½¿ç”¨ emoji å¢å¼ºå¯è¯»æ€§
   - ğŸš€ å¼€å§‹æ‰§è¡Œ
   - âœ… æˆåŠŸå®Œæˆ
   - âŒ æ‰§è¡Œå¤±è´¥
   - ğŸ”¹ èŠ‚ç‚¹æ ‡è¯†
   - ğŸ“‹ ä»»åŠ¡ä¿¡æ¯
   - ğŸ“Š æ•°æ®çŠ¶æ€
   - âš¡ æ‰§è¡Œå†å²
   - âš ï¸  é”™è¯¯è­¦å‘Š
   - â“ éœ€è¦æ¾„æ¸…

## æ€§èƒ½è€ƒè™‘

- `updates` æ¨¡å¼æ€§èƒ½æœ€å¥½ï¼Œè¾“å‡ºé‡é€‚ä¸­
- `values` æ¨¡å¼è¾“å‡ºé‡å¤§ï¼Œå¯èƒ½å½±å“ç»ˆç«¯æ€§èƒ½
- `debug` æ¨¡å¼è¾“å‡ºé‡æœ€å¤§ï¼Œä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨
- `verbose=False` å…³é—­è¾“å‡ºå¯è·å¾—æœ€ä½³æ€§èƒ½

## å®Œæ•´ç¤ºä¾‹

å‚è§ `notebook/example_stream_usage.py` è·å–å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹ã€‚
